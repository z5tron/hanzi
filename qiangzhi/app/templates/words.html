{% extends "base.html" %}

{% block meta %}
{{ super() }}
<meta name="viewport" content="width=device-width, initial-scale=1.">
{% endblock %}

{% block title %}Hanzi - {{ book }}{% endblock %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='chinese.css') }}">
{% endblock %}


{% block page_content %}
<div id="wordapp">
  <div class="jumbotron">
    <div class="container">
      <h1>书：{{ book }} ({{ words | length }})</h1>
      <h3>Earned POINTS: <span :class="['label', 'label-points', cur_xpoints > 0 ? 'label-purple' : 'label-danger']"><span class="glyphicon glyphicon-star"></span>[[ cur_xpoints ]]</span><button id="thumbs-up" type="button" class="btn btn-lg btn-secondary" v-on:click="cur_xpoints += 3; num_thumbs_up += 1"><span class="glyphicon glyphicon-thumbs-up">[[ num_thumbs_up ]]</span></button><button id="thumbs-down" type="button" class="btn btn-lg btn-secondary" v-on:click="cur_xpoints -= 3; num_thumbs_up -=1"><span class="glyphicon glyphicon-thumbs-down"></span></button>
</h3>
passed: [[ passed ]], failed: [[ failed ]]. <span id="wordId">Displayed [[ iword ]] out of [[ filterWords.length ]]</span>
    <!-- p><a class="btn btn-primary btn-lg" href="#" role="button">Learn more &raquo;</a></p -->
  </div>
</div>


<div class="row">
  <div class="col-xs-12">
    <ul class="pager">
      <li v-on:click="iword=Math.max(0, iword-wordsPerPage)"><a href="#">Prev</a></li>
      <li v-on:click="iword=0"><a href="#">First</a></li>
      <li v-on:click="iword=iwordLast"><a href="#">Last</a></li>
      <li v-on:click="iword=Math.min(words.length-1, iword+wordsPerPage)"><a href="#">Next</a></li>
    </ul>
  </div>
</div>

      
<div class="word-world" v-for="(word,iw) in wordList">
  <div class="word-box" v-if="show(word)">
    <form method="post" action="http://www.chinese-dictionary.org" class="inline">
      <div class="toolset col-xs-2">
	<div class="control raw">
	  <button id="btn-pass" type="button" name="stat-pass" class="btn btn-success btn-block btn-answer" v-on:click="markPoints(word, 2)" :disabled="word.cur_xpoints > 0">P(+2)</button>
	  <button id="btn-pass" type="button" name="stat-pass" class="btn btn-success btn-block btn-answer" v-on:click="markPoints(word, 1)" :disabled="word.cur_xpoints > 0">G(+1)</button>
          <input type="hidden" name="dico" :value="[[ word.word ]]" />
          <input type="hidden" name="dl" value="en" />
	  <button type="submit" class="btn btn-default btn-block btn-answer" name="search-word" value="submit_value">Search</button>
	  <button id="btn-fail" type="button" name="stat-fail" class="btn btn-danger btn-block btn-answer" v-on:click="markPoints(word, -10)" :disabled="word.cur_xpoints < 0">Fail</button>
	  <!-- button id="btn-skip" type="button" name="stat-skip" class="btn btn-default btn-block" v-on:click="skipWord(word)">Skip</button -->
	  <!-- button id="btn-skip" type="button" name="stat-fail" class="btn btn-default btn-block" v-on:click="markPoints(word, 1000000)" :disabled="word.cur_xpoints < 0">IgnoreForEver</button -->
        </div>
      </div>
      <div class="word col-xs-10"><p id="word" v-bind:class="['word-cell', status(word)]">[[ word.word ]]</p>
	<p><span class="word-related" v-for="r in word.related">[[ r ]]</span></p>
	<p id="wordStat">chapter [[ word.chapter ]], score=[[ word.cur_xpoints ]], streak=[[ word.streak ]], <!-- freq=[[ word.ifreq ]], --> points=<span :class='{label: true, "label-danger": word.tot_xpoints < 0, "label-default": word.tot_xpoints >= 0}'>[[ word.tot_xpoints ]]</span>, [[ word.num_pass ]]/[[ word.num_fail ]], [[ dateFormat(word.study_date) ]]</p>
      </div>
    </form>
  </div>
</div>

<div class="row">
  <div class="col-xs-12">
    <!-- button type="button" class="btn btn-lg btn-primary" --
      -- v-on:click="showNextList()">Next</button -->
    <ul class="pager">
      <li v-on:click="iword=Math.max(0, iword-wordsPerPage)"><a href="#">Prev</a></li>
      <li v-on:click="iword=0"><a href="#">First</a></li>
      <li v-on:click="iword=iwordLast"><a href="#">Last</a></li>
      <li v-on:click="iword=Math.min(words.length-1, iword+wordsPerPage)"><a href="#">Next</a></li>
    </ul>
  </div>
</div>

<div id="footer">
  <ul>
    <li>{{ 'today' }}, total days: {{ 'totalStudyDays' }}/{{totalDays}}, first day: {{ 'firstDay' }}</li>
    <li>pass: [[ passed ]], fail: [[ failed ]], passed this page: [[ passCurPage ]]</li>
    <li>Total points: <span class="label label-default">{{ tot_xpoints + cur_xpoints }}</span>, Today's points: <span class="label label-purple">[[ cur_xpoints ]]</span></li>
  </ul>
  
  <div class="container">
    <p class="text-muted credit">Developed by Z. Forest</p>
  </div>
</div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
  var ALL_WORDS = {{ words | tojson|safe}};
</script>
<script src="https://unpkg.com/vue@2.4.4/dist/vue.js"></script>
<script src="{{ url_for('static', filename='app.js') }}"></script>
{% endblock %}

